(this["webpackJsonpONE-dbc"]=this["webpackJsonpONE-dbc"]||[]).push([[51],{1287:function(e,t,a){"use strict";a.r(t);var n=a(8),o=a(6),c=a(3),l=a(2),s=a.n(l),r=a(0),i=a(188),u=a(322),b=a(189),j=a(35),d=a(53),O=a(127),g=a(91),m=a(1183),p=a(1180),f=a(1174),x=a(409),h=a(173),v=a(23),S=a(160),y=a(62),C=a(103),k=a(17),N=a(19),w=a(143),L=a(39),T=a(20),R=a(29),B=a(138),I=a(27),V=a(32),q=a(1),E={3:180,6:90,8:-90},P=function(e){var t=e.closeDialog,a=e.dialogOpen,l=e.onSetNotification,P=e.userId,A=Object(B.a)(),F=Object(I.b)(),M=Object(V.a)(),U=Object(R.b)(),z=Object(T.b)().languageVars.pages.editProfile,D=Object(r.useState)(!1),W=Object(c.a)(D,2),Z=W[0],J=W[1],H=Object(r.useState)(!1),G=Object(c.a)(H,2),K=G[0],Q=G[1],X=Object(r.useState)(!1),Y=Object(c.a)(X,2),$=Y[0],_=Y[1],ee=Object(r.useState)("Loading"),te=Object(c.a)(ee,2),ae=te[0],ne=te[1],oe=Object(r.useState)(!1),ce=Object(c.a)(oe,2),le=ce[0],se=ce[1],re=Object(r.useState)(null),ie=Object(c.a)(re,2),ue=ie[0],be=ie[1],je=Object(r.useState)(null),de=Object(c.a)(je,2),Oe=de[0],ge=de[1],me=Object(r.useState)(null),pe=Object(c.a)(me,2),fe=pe[0],xe=pe[1],he=Object(r.useState)(null),ve=Object(c.a)(he,2),Se=ve[0],ye=ve[1],Ce=Object(r.useState)(null),ke=Object(c.a)(Ce,2),Ne=ke[0],we=ke[1],Le=Object(r.useState)({x:0,y:0}),Te=Object(c.a)(Le,2),Re=Te[0],Be=Te[1],Ie=Object(r.useState)(0),Ve=Object(c.a)(Ie,2),qe=Ve[0],Ee=Ve[1],Pe=Object(r.useState)(1),Ae=Object(c.a)(Pe,2),Fe=Ae[0],Me=Ae[1],Ue=Object(r.useState)(null),ze=Object(c.a)(Ue,2),De=ze[0],We=ze[1],Ze=Object(r.useState)(!1),Je=Object(c.a)(Ze,2),He=Je[0],Ge=Je[1],Ke=Object(r.useState)("square"),Qe=Object(c.a)(Ke,2),Xe=Qe[0],Ye=Qe[1],$e=Object(r.useState)(!1),_e=Object(c.a)($e,2),et=_e[0],tt=_e[1],at=Object(r.useState)(!1),nt=Object(c.a)(at,2),ot=nt[0],ct=nt[1],lt=Object(r.useState)(!1),st=Object(c.a)(lt,2),rt=st[0],it=st[1],ut=Object(r.useState)(null),bt=Object(c.a)(ut,2),jt=bt[0],dt=bt[1],Ot={logo:Object(k.b)("imageUpload",z.forms.pictureTab.image,{name:"logo",placeholder:z.forms.pictureTab.image,stateClass:null,withView:!1,showLabel:!1,label:null,selectButtonText:"Upload image",changeButtonText:"Change"},"",null,{required:!1},!0,{xs:12,sm:null,md:null,lg:null,xl:null,fullWidth:!0})},gt=Object(r.useState)(Object(o.a)({},Ot)),mt=Object(c.a)(gt,2),pt=mt[0],ft=mt[1];Object(r.useEffect)((function(){var e=!0;return e&&!et&&P&&Object(n.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_(!0),e.next=4,Object(L.k)(P);case 4:t=e.sent,dt(t),t.logo&&t.logo.code&&(xe(t.logo.code),ye(t.logo.type),Ye(t.logo.style||"square")),a=Object(k.a)(pt,t,null),ft((function(e){return Object(o.a)(Object(o.a)({},e),a.adjustedForm)})),J(a.formValid),_(!1),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))(),function(){e=!1}}),[P]);var xt,ht=Object(r.useCallback)((function(e,t){We(t)}),[]),vt=function(e){return new Promise((function(t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)}),!1),a.readAsDataURL(e)}))},St=function(){var e=Object(n.a)(s.a.mark((function e(t,a){var n,o,c,l,r,u,j,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t[0]instanceof File)){e.next=26;break}return n=t[0],o={maxSizeMB:n.size>8e6?.05:2,maxWidthOrHeight:550,useWebWorker:!0},e.next=5,Object(i.a)(n,o);case 5:return c=e.sent,l=Object(N.o)(c,+new Date),be(l),e.next=10,vt(l);case 10:return r=e.sent,e.next=13,Object(b.getOrientation)(l);case 13:if(u=e.sent,!(j=E[u])){e.next=19;break}return e.next=18,Object(w.b)(r,j);case 18:r=e.sent;case 19:ge(l.type),we(r),d=Object(k.a)(pt,l.name,a),ft(d.adjustedForm),J(d.formValid),Q(!0),se(!1);case 26:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),yt=function(){ft(Ot),be(null),ge(null),xe(null),ye(null),we(null),Be({x:0,y:0}),Ee(0),Me(1),Ye("square"),tt(!1),ct(!1),it(!1),t()},Ct=function(){var e=Object(n.a)(s.a.mark((function e(t){var a,n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),_(!0),a=Object(o.a)({},jt),e.prev=3,n=null,!ue){e.next=17;break}return it(!0),e.next=9,Object(w.a)(Ne,De,qe,Oe);case 9:c=e.sent,n="image/png"===Oe?c.split("data:image/png;base64,").pop():"/9j/".concat(c.split("/9j/").pop()),ne(z.messages.loading.analyzingImageFile),a.logo={},a.logo.code=n,a.logo.type=Oe,ne(z.messages.loading.uploadingNewImage),be(null);case 17:return a.logo.style=Xe,He&&(a.logo.code=null,a.logo.type=null),ne(z.messages.loading.updatingVcard),e.next=22,Object(L.u)(P,a);case 22:xe(a.logo?a.logo.code:null),ye(a.logo?a.logo.type:null),ft((function(e){return Object(o.a)(Object(o.a)({},e),{},{logo:Object(o.a)(Object(o.a)({},e.logo),{},{elementSetup:Object(o.a)(Object(o.a)({},e.logo.elementSetup),{},{stateClass:null})})})})),se(!0),Q(!1),_(!1),l({message:z.messages.notifications.profileInfoUpdateSuccess,type:"success"}),yt(),e.next=36;break;case 32:e.prev=32,e.t0=e.catch(3),_(!1),l({message:z.messages.notifications.profileInfoUpdateError,type:"error"});case 36:case"end":return e.stop()}}),e,null,[[3,32]])})));return function(t){return e.apply(this,arguments)}}(),kt=le||K&&!Z||!K||$;return Object(q.jsx)(S.a,{open:a,onClose:yt,title:"".concat(jt&&jt.firstName?jt.firstName:""," ").concat(jt&&jt.lastName?jt.lastName:""," Logo"),loading:!1,actionButtonOne:Object(q.jsx)(g.a,{color:"secondary",onClick:function(e){return Ct(e)},disabled:kt,className:M.defaultButton,style:{backgroundColor:!kt&&U},children:z.buttons.updateLogo}),children:Object(q.jsx)(j.a,{children:$?Object(q.jsx)(v.a,{loadingText:"".concat(K?ae:z.messages.loading.loadingProfileInfo)}):Object(q.jsx)(j.a,{children:Object(q.jsxs)(j.a,{className:A.logoContainer,children:[Object(q.jsx)(O.a,{container:!0,spacing:3,children:Object(q.jsxs)(O.a,{item:!0,xs:12,children:[Object(q.jsxs)(j.a,{className:"".concat(F.panel," ").concat(jt&&jt.logo&&jt.logo.code&&!ue&&!He?A.logoPanel:""),children:[jt&&jt.logo&&jt.logo.code&&!ue&&!He&&!rt&&Object(q.jsx)(j.a,{className:"".concat(A.currenLogoContainerSm," ").concat("circle"===Xe?A.currenLogoContainerSmCircle:""),children:Object(q.jsx)("img",{src:"data:".concat(jt&&jt.logo&&jt.logo.type?jt.logo.type:Se,"\n                            ;base64,").concat(jt&&jt.logo&&jt.logo.code?jt.logo.code:fe),alt:"Profile"})}),(ue||rt)&&Object(q.jsxs)(j.a,{className:A.cropper,children:[Object(q.jsx)(j.a,{className:"".concat(A.cropContainer," ").concat("circle"===Xe?A.circleCropContainer:""),children:Object(q.jsx)(u.a,{image:Ne,crop:Re,zoom:Fe,rotation:qe,aspect:1,onCropChange:Be,onCropComplete:ht,onZoomChange:Me,onRotationChange:Ee})}),!$&&Object(q.jsxs)(j.a,{className:A.controls,children:[Object(q.jsxs)(j.a,{className:A.sliderContainer,children:[Object(q.jsx)(d.a,{variant:"overline",classes:{root:A.sliderLabel},children:"Zoom"}),Object(q.jsx)(m.a,{value:Fe,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:function(e,t){return Me(t)},classes:{root:A.sliderRoot,thumb:A.sliderThumb,track:A.sliderTrack,rail:A.sliderRail,mark:A.sliderMark,markActive:A.markActive}})]}),Object(q.jsxs)(j.a,{className:A.sliderContainer,children:[Object(q.jsx)(d.a,{variant:"overline",classes:{root:A.sliderLabel},children:"Rotate"}),Object(q.jsx)(m.a,{value:qe,min:0,max:360,step:1,"aria-labelledby":"Rotation",classes:{root:A.sliderRoot,thumb:A.sliderThumb,track:A.sliderTrack,rail:A.sliderRail,mark:A.sliderMark,markActive:A.markActive},onChange:function(e,t){return Ee(t)}})]})]})]}),(xt=pt,Object.keys(xt).map((function(e,t){return Object(q.jsx)(y.a,{elementType:xt[e].elementType,label:xt[e].elementLabel,value:xt[e].value,elementOptions:xt[e].elementOptions,touched:xt[e].touched,valid:xt[e].isValid,errorMessage:xt[e].errorMessage,shouldValidate:xt[e].validtationRules,elementSetup:xt[e].elementSetup,changed:function(t){return St(t,e)},grid:xt[e].grid,disabled:$},e+t)}))),jt&&jt.logo&&jt.logo.code&&!ue&&!He&&Object(q.jsx)(g.a,{color:"secondary",onClick:function(e){return Ge(!0),Q(!0),J(!0),void se(!1)},className:"".concat(M.defaultButton," ").concat(A.removeLogoButton," ").concat(F.panelButton),style:{color:U.color.code,borerColor:U.color.code},disabled:$,children:z.buttons.removeLogo})]}),jt&&Object(q.jsx)(j.a,{className:"".concat(F.panel),children:Object(q.jsx)(j.a,{className:A.logoStyleContainer,children:Object(q.jsx)(h.a,{component:"fieldset",children:Object(q.jsxs)(f.a,{"aria-label":"logoStyle",name:"logoStyle",value:Xe,onChange:function(e){!fe&&!ue||He?ct(!0):(Ye(e.target.value),Q(!0),J(!0),se(!1),tt(!0))},children:[Object(q.jsx)(x.a,{value:"square",control:Object(q.jsx)(p.a,{disabled:$}),label:"Square"}),Object(q.jsx)(x.a,{value:"circle",control:Object(q.jsx)(p.a,{disabled:$}),label:"Circle"})]})})})})]})}),Object(q.jsx)(C.a,{open:ot,onClose:function(){ct(!1)},title:z.messages.notifications.noLogo.title,type:"warning",children:Object(q.jsx)(j.a,{children:Object(q.jsx)(d.a,{variant:"body1",align:"center",component:"p",children:z.messages.notifications.noLogo.description})})})]})})})})};P.defaultProps={dialogOpen:!1,userId:null},t.default=P}}]);